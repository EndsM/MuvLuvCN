## Note

This note will be written in chinese. `English user can refer to git history to see the comments.`

该笔记将用中文进行记录。

## The usage of this note （该笔记的用处）

该笔记用于记录对于一些游戏内容的修改细节、对于中文命名改为英文命名的的记录，以及一些其他需要众人知悉的改动细节。

## The content （内容）

### 2023.11.7

在on_action部分，将“被beta攻陷地区”的效果里，把地区标记为betaland的条目放到了FROM.FROM里面，因为原本的方法使得该效果处于country scope里面。

将common/decision以及其子目录改为了replace的加载方法，因此保证在未来hoi4版本更新时，可以减少对于该部分的修改。

将common/units/equipment这一路径的replace加载方式正确的进行了实装，并且目前将让游戏运行的最低装备文件需求进行了加入，以mod原本的装备属性为最高优先级进行覆盖，理论上和修改前区别是没有的。这一改动的目的是为了在未来对装备进行更多重构或者现代化改修的时候，可以不用担心原版装备的问题。

在特种作战学说这一科技树中，注释掉了submod里面的特殊兵种的加成以减少相关报错，并将相关加成给予了强袭步行攻击机，因此事实上加强了这一海军陆战队等价兵种。

给游戏地图中增加了5个`缺失的港口建筑`的`位置描述`，因此修复了游戏AI功能遍历海军逻辑时，由于该exception而无限循环，导致CPU、GPU、内存占用无限大而最终`内存泄漏`崩溃的问题。

common/scripted_effects路径的加载方式也改为了replace。

删除了名字错误的scripted_gui文件夹，正确名称的保留了。

修复了“超事件”的一些错误，这个也是可能导致崩溃的原因。09c419f 以及 cc5e278

游戏开始的betaland在加载后人口恢复的问题，适役人口依旧是0的，但是很明显游戏没有自带修正平民人口的修正，导致在加载后依旧是以state历史为准的。

这一问题不适宜使用修改state历史的方式解决，可以在beta事件1里面对人口进行削减，这个可以之后进行测试。

### 2023.11.8

今天先从简单的开始处理，开始把国家精神部分的中文命名改为英文命名，并且添加相应的localization，注意，这一改动必定会导致旧有存档无效。（暂未开始执行）

在14:25 UTC-8时遇到了新的崩溃问题，这次有两个怀疑对象，1. ai策略部分很多遗失了取消条件的策略。2.on_action部分还在触发原版的很多东西，但是这些东西在mod里面缺失对应的地址，可能引发空地址问题。

根据崩溃时的行为是“ping_client”，认为依旧是和AI相关的错误，目前没有在log里面看到有直接崩溃风险的部分，但是目前的怀疑目标为：ai_templates。

再次修补了昨天添加的港口位置，这里列出有问题的省份ID：8913、11960、13226、13228、13230

### 2023.11.9

今天一开始，首先修复了经济法案中战争总动员的判断声明放错地方的问题。

然后就是接下来要开始动手修改命名问题了，这一点是必定破坏存档兼容性的，所以从这里先记一下。

国联分担协议修正案这个精神可以考虑之后，删除各国的分别的精神，然后移动到uni下面的一个通用精神。

已完成非洲的idea文件里面的，中文命名改为英文命名的工作。

### 2023.11.10

首先给美国写个AI国策选取树，目前太喜欢点那些没用的东西了。右边那坨国策回头既可以改名，也可以直接删掉，重新写成美国的全球援助线和门罗主义的二选一。

AI国策组写好了，理论上让美国变强了10倍甚至9倍，强而有力啊强而有力。

回头要解决一下BETA把全球的光线级都调到东南亚的问题，我觉得大东亚联合再怎么顶也顶不住这个。

scripted_enums和equipment_groups需要回头重构一下。

### 2023.11.11

暂时把战略研究会这里，用society-社团的翻译来进行了。